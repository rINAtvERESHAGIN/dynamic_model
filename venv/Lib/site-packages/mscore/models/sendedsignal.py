import uuid
from django.db.models import Model, UUIDField, CharField, DateTimeField, BooleanField, IntegerField, ForeignKey, CASCADE
from django.contrib.contenttypes.models import ContentType
from .choices import SIGNAL_TYPE_CHOICES


class SendedSignal(Model):
    uid = UUIDField(default=uuid.uuid4)
    sender = CharField(max_length=100)
    object = UUIDField()
    type = CharField(max_length=50, choices=SIGNAL_TYPE_CHOICES)
    created = DateTimeField(auto_now_add=True)
    changed = DateTimeField(auto_now=True)
    listeners = IntegerField(default=0)
    listeners_complete = IntegerField(default=0)
    is_sent = BooleanField(default=False)
    is_error = BooleanField(default=False)
    is_ended = BooleanField(default=False)

    def __str__(self):
        return '{}({}) send {} at {} to {} listners'.format(self.sender, self.uid, self.type, self.created, self.listeners)